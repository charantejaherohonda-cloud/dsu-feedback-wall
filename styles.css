const API = "http://localhost:5000";

function openModal() {
  document.getElementById("modal").style.display = "block";
}

function closeModal() {
  document.getElementById("modal").style.display = "none";
}

function loadFeedback() {
  fetch(${API}/feedback)
    .then(res => res.json())
    .then(data => {
      const list = document.getElementById("feedbackList");
      list.innerHTML = "";

      data.forEach(f => {
        list.innerHTML += `
          <div class="card">
            <h3>${f.title}</h3>
            <p>${f.description}</p>

            <div class="meta">
              <span class="badge">${f.category}</span>
              <span class="badge status">${f.status}</span>
            </div>

            <button class="upvote" onclick="upvote(${f.id})">
              üëç ${f.upvotes}
            </button>
          </div>
        `;
      });
    });
}

function postFeedback() {
  fetch(${API}/feedback, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      title: title.value,
      description: desc.value,
      category: category.value,
      author: author.value
    })
  }).then(() => {
    closeModal();
    loadFeedback();
  });
}

function upvote(id) {
  fetch(${API}/feedback/${id}/upvote, { method: "POST" })
    .then(loadFeedback);
}

loadFeedback();
